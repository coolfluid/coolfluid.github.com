<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>COOLFluiD: Flexible mesh data structure</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="coolfluid.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">COOLFluiD
   &#160;<span id="projectnumber">Release  kernel</span>
   </div>
   <div id="projectbrief">COOLFluiD is a Collaborative Simulation Environment (CSE) focused on complex MultiPhysics simulations.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">COOLFluiD Documentation</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Flexible mesh data structure </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="mesh_features"></a>
Features</h1>
<ul>
<li>Built on the Component environment</li>
<li>Unlimited nesting of regions to allow complex topologies.</li>
<li>Unstructured meshes for complex geometries</li>
<li>Support for both Continuous/Discontinuous fields</li>
<li>Support for fields based on arbitrary shape-function</li>
</ul>
<h1><a class="anchor" id="mesh_description"></a>
Description</h1>
<p>The mesh is assembled from specialized components. The two most important components are the topology and the geometry_fields.</p><ul>
<li>topology is a component describing the physical structure of the mesh. A plane is constructed out of a body and wings. The wings itself can be constructed out of different patches. An infinite nesting is possible.</li>
<li>geometry_fields is a component that stores all the fields that are defined in the vertices of the whole mesh. The mesh coordinates are for instance a vector-field defined in here-in .</li>
</ul>
<p>An example mesh tree of a plane: </p><pre class="fragment">tree                                                  |  type
-------------------------------------------------------------------------------
mesh                                                  |  cf3::mesh::Mesh
                                                      |
    topology                                          |  cf3::mesh::Region
        surrounding                                   |  cf3::mesh::Region
        body                                          |  cf3::mesh::Region
        wings                                         |  cf3::mesh::Region
            wing_1                                    |  cf3::mesh::Region
            wing_2                                    |  cf3::mesh::Region
                patch_1                               |  cf3::mesh::Region
                patch_2                               |  cf3::mesh::Region
        tail                                          |  cf3::mesh::Region
                                                      |
    geometry                                          |  cf3::mesh::Dictionary
        coordinates                                   |  cf3::mesh::Field
</pre><h2><a class="anchor" id="Elements"></a>
Elements</h2>
<p>Inside the regions there exist more nested components of the type Entities, defining elements. Every element type is grouped separately. Looking at the region "body" more deeply: </p><pre class="fragment">tree                                                  |  type
-------------------------------------------------------------------------------
...                                                   |
    body                                              |  cf3::mesh::Mesh
                                                      |
        quads                                         |  cf3::mesh::Entities
            element_type                              |  cf3::mesh::ElementType
            spaces                                    |  cf3::common::Group
                geometry                              |  cf3::mesh::Space
                    shape_function                    |  cf3::mesh::ShapeFunction
                    connectivity                      |  cf3::mesh::Connectivity
                                                      |
        triags                                        |  cf3::mesh::Entities
            element_type                              |  cf3::mesh::ElementType
            spaces                                    |  cf3::common::Group
                geometry                              |  cf3::mesh::Space
                    shape_function                    |  cf3::mesh::ShapeFunction
                    connectivity                      |  cf3::mesh::Connectivity
...                                                   |
</pre><p>In this tree you can see that the body of the plane is constructed out of quadrilaterals and triangles. The element type of each is defined in the component "element_type". The element_type provides all information needed to describe the element and transformations of a physical space to a mapped space.</p>
<p>The connectivity-table of the elements, which for each element describes which nodes it connects, is stored in the component "connectivity". It is essentially a table where each row describes one element, and the values of each row point to indexes in the geometry field-group at "mesh/geometry".</p>
<h2><a class="anchor" id="spaces"></a>
Spaces and Dictionaries</h2>
<p>The concept of "space" is here introduced as an invisible mesh completely overlapping the original mesh. It has exactly the same elements as the original mesh, but every element is defined by a different set of nodes.</p>
<p>One "space" that is always there is called "geometry". This name is not by coincidence the same as the Dictionary "geometry", as this space and dictionary together describe the actual mesh geometry.</p>
<p>When a mesh is defined with Lagrange-P1 elements (nodes in vertices), but a field of a higher order P2 is desired, another "space" can be created a posteriori. Let's create the space "P2" in the same tree: </p><pre class="fragment">tree                                                  |  type
-------------------------------------------------------------------------------
...                                                   | 
    body                                              |  cf3::mesh::Mesh
        quads                                         |  cf3::mesh::Entities
            element_type                              |  cf3::mesh::ElementType
            spaces                                    |  cf3::common::Group
                geometry                              |  cf3::mesh::Space
                    ...                               |
                P2                                    |  cf3::mesh::Space
                    shape_function                    |  cf3::mesh::ShapeFunction
                    connectivity                      |  cf3::mesh::Connectivity
        triags                                        |  cf3::mesh::Entities
            ...                                       |
...                                                   |
</pre><p>The shape_function here describes Lagrange-P2 quadrilateral elements with 9 nodes. This space has therefore a connectivity-table with 9 columns instead of 4 for the (Lagrange-P1) geometry space. What is evident now is that the entries of this connectivity table are indexes to something that does not exist yet: another SpaceFields.</p>
<p>A SpaceFields is characterized by 2 things:</p><ul>
<li>Region it is applied to: By default a field is applied to the entire topology. It is however possible to select a more specific region.</li>
<li>Space it is linked to. A field group is closely linked to a space. It is therefore common practice to name both the space and the SpaceFields similarly.</li>
</ul>
<p>Fields that share the same space and region are grouped together inside the SpaceFields. Hence its name.</p>
<p>The mesh tree now has to contain the SpaceFields as well. </p><pre class="fragment">tree                                                  |  type
-------------------------------------------------------------------------------
mesh                                                  |  cf3::mesh::Mesh
                                                      |
    topology                                          |  cf3::mesh::Region
        surrounding                                   |  cf3::mesh::Region
        body                                          |  cf3::mesh::Region
        wings                                         |  cf3::mesh::Region
            ...                                       |
        tail                                          |  cf3::mesh::Region
                                                      |
    geometry                                          |  cf3::mesh::Dictionary
        coordinates                                   |  cf3::mesh::Field
                                                      |
    P2                                                |  cf3::mesh::Dictionary
        coordinates                                   |  cf3::mesh::Field
        pressure                                      |  cf3::mesh::Field
        velocity                                      |  cf3::mesh::Field
</pre><h2><a class="anchor" id="_mesh_remarks"></a>
Remarks</h2>
<p>It can be noticed that the coordinates Field is not strictly necessary in the P2 SpaceFields, as it can be computed on the fly through the information from the P2 and geometry shape functions, and the geometry coordinates.</p>
<p>The creation of the P2 space and SpaceFields is completely optional and for demonstration purposes only. It is perfectly possible to create all desired fields in the geometry space and fieldgroup. Note however that the geometry fieldgroup only supports continuous fields.</p>
<p>Discontinuous fields require a separate space.</p>
<dl class="section note"><dt>Note</dt><dd>Following should go to different page for developers </dd></dl>
<h1><a class="anchor" id="_mesh_elements"></a>
Elements</h1>
<p>The component grouping elements of the same type and region are of the abstract type <a class="el" href="classcf3_1_1mesh_1_1_entities.html">cf3::mesh::Entities</a>.</p><ul>
<li><a class="el" href="classcf3_1_1mesh_1_1_cells.html">cf3::mesh::Cells</a></li>
<li><a class="el" href="classcf3_1_1mesh_1_1_faces.html">cf3::mesh::Faces</a></li>
<li><a class="el" href="classcf3_1_1mesh_1_1_cell_faces.html">cf3::mesh::CellFaces</a> (like Faces, but with Cell-connectivity)</li>
</ul>
<p>The distinction is made between <a class="el" href="classcf3_1_1mesh_1_1_cells.html">cf3::mesh::Cells</a> and <a class="el" href="classcf3_1_1mesh_1_1_faces.html">cf3::mesh::Faces</a> for the purpose of identification only. It is easier in algorithms to identify what is a cell or a face: </p><div class="fragment"><div class="line"><a class="code" href="_foreach_8hpp.html#a56ec391fe68d302858697046988c05ac">boost_foreach</a>( <span class="keyword">const</span> <a class="code" href="classcf3_1_1mesh_1_1_cells.html">cf3::mesh::Cells</a>&amp; cells, find_components_recursively&lt;cf3::mesh::Cells&gt;(<a class="code" href="namespaceatest-boussinesq.html#a6b3beaaa91563cd954a3b0a78705e5e8">mesh</a>) )</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// only volume elements are looped over.</span></div>
<div class="line">}</div>
<div class="line"><a class="code" href="_foreach_8hpp.html#a56ec391fe68d302858697046988c05ac">boost_foreach</a>( <span class="keyword">const</span> <a class="code" href="classcf3_1_1mesh_1_1_faces.html">cf3::mesh::Faces</a>&amp; faces, find_components_recursively&lt;cf3::mesh::Faces&gt;(<a class="code" href="namespaceatest-boussinesq.html#a6b3beaaa91563cd954a3b0a78705e5e8">mesh</a>) )</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// only face elements are looped over.</span></div>
<div class="line">}</div>
<div class="line"><a class="code" href="_foreach_8hpp.html#a56ec391fe68d302858697046988c05ac">boost_foreach</a>( <span class="keyword">const</span> <a class="code" href="classcf3_1_1mesh_1_1_entities.html">cf3::mesh::Entities</a>&amp; elements, find_components_recursively&lt;cf3::mesh::Elements&gt;(<a class="code" href="namespaceatest-boussinesq.html#a6b3beaaa91563cd954a3b0a78705e5e8">mesh</a>) )</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// both face and volume elements are looped over.</span></div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="_working_with_fields"></a>
Working with fields</h1>
<p>Often one wants to loop over fields through the use of the elements. </p><div class="fragment"><div class="line"><span class="comment">// Assume we have a cf3::mesh::Field &quot;mesh/P2/velocity&quot; called velocity</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// Get the dictionary this field is located in.</span></div>
<div class="line"><span class="keyword">const</span> <a class="code" href="classcf3_1_1mesh_1_1_dictionary.html">cf3::mesh::Dictionary</a>&amp; dict = <a class="code" href="namespaceatest-ufem-velocitygradient.html#aecfeca1289d00fbe5fc76a8dd5295913">velocity</a>.dict();</div>
<div class="line"></div>
<div class="line"><span class="comment">// Loop over all Entities that this dictionary is defined for</span></div>
<div class="line"><a class="code" href="_foreach_8hpp.html#a56ec391fe68d302858697046988c05ac">boost_foreach</a>( <span class="keyword">const</span> Handle&lt;cf3::mesh::Entities const&gt;&amp; entities, dict.<a class="code" href="classcf3_1_1mesh_1_1_dictionary.html#a55049d489531041ecb18a3ce8cbde4bb">entities_range</a>() )</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// The dictionary specifies which space to use</span></div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classcf3_1_1mesh_1_1_space.html">cf3::mesh::Space</a>&amp; space = entities.space(dict);</div>
<div class="line"></div>
<div class="line">  <span class="comment">// Loop over every element of this type</span></div>
<div class="line">  <span class="keywordflow">for</span> (<a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> <a class="code" href="namespaceatest-ufem-navier-stokes-restart.html#ad61514049e7f24fdbbf7891053708d1d">elem</a>=0; <a class="code" href="namespaceatest-ufem-navier-stokes-restart.html#ad61514049e7f24fdbbf7891053708d1d">elem</a>&lt;entities.size(); ++<a class="code" href="namespaceatest-ufem-navier-stokes-restart.html#ad61514049e7f24fdbbf7891053708d1d">elem</a>)</div>
<div class="line">  {   </div>
<div class="line">    <span class="comment">// loop over every point of this element</span></div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> point=0; point&lt;shape_function().nb_nodes(); ++point)</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="namespaceatest-ufem-velocitygradient.html#aecfeca1289d00fbe5fc76a8dd5295913">velocity</a>[ space.<a class="code" href="classcf3_1_1mesh_1_1_space.html#a82cea0406e095c0d2b1b32bacafe28bc">connectivity</a>()[<a class="code" href="namespaceatest-ufem-navier-stokes-restart.html#ad61514049e7f24fdbbf7891053708d1d">elem</a>][point] ][ <a class="code" href="namespacecf3.html#a29ebdb69a556c88aa0896eb91b827ef5a872a756ecc227f3c58ba33fb2693c93c">XX</a> ] = 1.5;</div>
<div class="line">      <a class="code" href="namespaceatest-ufem-velocitygradient.html#aecfeca1289d00fbe5fc76a8dd5295913">velocity</a>[ space.<a class="code" href="classcf3_1_1mesh_1_1_space.html#a82cea0406e095c0d2b1b32bacafe28bc">connectivity</a>()[<a class="code" href="namespaceatest-ufem-navier-stokes-restart.html#ad61514049e7f24fdbbf7891053708d1d">elem</a>][point] ][ <a class="code" href="namespacecf3.html#a29ebdb69a556c88aa0896eb91b827ef5a7839aff0e1cbdb888e2cc2aecb232702">YY</a> ] = 0.1;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p> Notice that in this case the vertices that are shared between elements are visited multiple times. This is only the case for continuous spaces. For discontinuous spaces the vertices are never shared.</p>
<p>You can also loop over the field directly: </p><div class="fragment"><div class="line"><span class="comment">// Assume we have a cf3::mesh::Field &quot;mesh/P2/velocity&quot; called velocity,</span></div>
<div class="line"><span class="comment">// and we want it to assign a rotational velocity around (0,0)</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// Get the dictionary this field is located in.</span></div>
<div class="line"><span class="keyword">const</span> <a class="code" href="classcf3_1_1mesh_1_1_dictionary.html">cf3::mesh::Dictionary</a>&amp; dict = <a class="code" href="namespaceatest-ufem-velocitygradient.html#aecfeca1289d00fbe5fc76a8dd5295913">velocity</a>.dict();</div>
<div class="line"></div>
<div class="line"><span class="comment">// A dictionary also has a coordinates field that can be used</span></div>
<div class="line"><span class="keyword">const</span> <a class="code" href="classcf3_1_1mesh_1_1_field.html">cf3::mesh::Field</a>&amp; <a class="code" href="namespacecf3_1_1solver_1_1actions_1_1_proto.html#ae6b0ac022fe7fa52c7620c959af8fc28">coordinates</a> = dict.<a class="code" href="classcf3_1_1mesh_1_1_dictionary.html#aee9605efa1b943fb384ffbe64d3aff7d">coordinates</a>();</div>
<div class="line"></div>
<div class="line"><span class="comment">// Loop over all field indices</span></div>
<div class="line"><span class="keywordflow">for</span> (<a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> point=0; point&lt;dict.<a class="code" href="classcf3_1_1mesh_1_1_dictionary.html#a7b57596f80978d22c6a37ff1470c7316">size</a>(); ++point)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="namespaceatest-ufem-velocitygradient.html#aecfeca1289d00fbe5fc76a8dd5295913">velocity</a>[point][<a class="code" href="namespacecf3.html#a29ebdb69a556c88aa0896eb91b827ef5a872a756ecc227f3c58ba33fb2693c93c">XX</a>] =  coordinates[point][<a class="code" href="namespacecf3.html#a29ebdb69a556c88aa0896eb91b827ef5a7839aff0e1cbdb888e2cc2aecb232702">YY</a>];</div>
<div class="line">  <a class="code" href="namespaceatest-ufem-velocitygradient.html#aecfeca1289d00fbe5fc76a8dd5295913">velocity</a>[point][<a class="code" href="namespacecf3.html#a29ebdb69a556c88aa0896eb91b827ef5a7839aff0e1cbdb888e2cc2aecb232702">YY</a>] = -coordinates[point][<a class="code" href="namespacecf3.html#a29ebdb69a556c88aa0896eb91b827ef5a872a756ecc227f3c58ba33fb2693c93c">XX</a>];</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Jun 14 2015 21:20:18 for COOLFluiD by&nbsp;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1</small></address>
<table width="100%">
  <tr>
    <td>
    </td>
    <td align="right" valign="center">
      Send comments to:<br>
      <a href="mailto:coolfluid@vki.ac.be">COOLFluiD Web Admin</a>
    </td>
  </tr>
</table>
</body>
</html>
