<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>COOLFluiD: cf3/math/LSS/Trilinos/TrilinosDetail.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="coolfluid.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">COOLFluiD
   &#160;<span id="projectnumber">Release  kernel</span>
   </div>
   <div id="projectbrief">COOLFluiD is a Collaborative Simulation Environment (CSE) focused on complex MultiPhysics simulations.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_1a2068f198ac163e753692de222d86be.html">cf3</a></li><li class="navelem"><a class="el" href="dir_8e7220cfa0d03007e7033fe1364fb850.html">math</a></li><li class="navelem"><a class="el" href="dir_6d28eb56f549a70234b72b52d0911525.html">LSS</a></li><li class="navelem"><a class="el" href="dir_4ba54ba474777bd511c951df31bf5a4a.html">Trilinos</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">TrilinosDetail.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_trilinos_detail_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright (C) 2010 von Karman Institute for Fluid Dynamics, Belgium</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// This software is distributed under the terms of the</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// GNU Lesser General Public License version 3 (LGPLv3).</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// See doc/lgpl.txt and doc/gpl.txt for the license text.</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;set&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_comm_8hpp.html">common/PE/Comm.hpp</a>&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_comm_pattern_8hpp.html">common/PE/CommPattern.hpp</a>&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_log_8hpp.html">common/Log.hpp</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_variables_descriptor_8hpp.html">math/VariablesDescriptor.hpp</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_trilinos_detail_8hpp.html">math/LSS/Trilinos/TrilinosDetail.hpp</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_trilinos_vector_8hpp.html">TrilinosVector.hpp</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;Epetra_Operator.h&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacecf3.html">cf3</a> {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keyword">namespace </span>math {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">namespace </span>LSS {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keyword">namespace </span>detail</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;{</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter.html">   40</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter.html">GidConverter</a></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;{</div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter.html#a55239b5970154fd1e562ea4a17e97c66">   42</a></span>&#160;  <a class="code" href="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter.html#a55239b5970154fd1e562ea4a17e97c66">GidConverter</a>(<span class="keyword">const</span> std::vector&lt;Uint&gt;&amp; periodic_links_nodes, <span class="keyword">const</span> std::vector&lt;bool&gt;&amp; <a class="code" href="namespaceutest-zoltan-phg-periodic.html#aafeb66bf94b2b8727cb6c0bf275d77d0">periodic_links_active</a>, <a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html">common::PE::CommPattern</a>&amp; cp)</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="_assertions_8hpp.html#afc37f1da5066c36c3ab4bec9916bb919">cf3_assert</a>(periodic_links_active.size() == periodic_links_nodes.size());</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> nb_nodes = cp.<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html#a2ae90dcd92e4a1c700dbdd10b78021f5">gid</a>()-&gt;size();</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter.html#ac171b0b852cc936f754d5e5c54cd4305">gids</a>.resize(nb_nodes);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    cp.<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html#a2ae90dcd92e4a1c700dbdd10b78021f5">gid</a>()-&gt;pack(&amp;<a class="code" href="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter.html#ac171b0b852cc936f754d5e5c54cd4305">gids</a>[0]);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm.html">common::PE::Comm</a>&amp; comm = <a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm.html#acde39a003bff65c47326f0b0b8610c7e">common::PE::Comm::instance</a>();</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> <a class="code" href="namespaceatest-ufem-navier-stokes-semi-implicit-laminar-channel-2d.html#ac7ab4d2aec28fbe3b32a56b67a766c33">nb_procs</a> = comm.<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm.html#a7b57596f80978d22c6a37ff1470c7316">size</a>();</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespaceutest-zoltan-phg-periodic.html#ad73008b6ed5017afc0f317696b61ca18">my_rank</a> = comm.<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm.html#a3473b7dc6bd43215734cdefc4b0f0d28">rank</a>();</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">if</span>(periodic_links_nodes.empty())</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="keywordtype">int</span> nb_local_nodes = 0;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i != nb_nodes; ++i)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keywordflow">if</span>(cp.<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html#a51ea9eb6a3ff209a2385fec4358e2bf2">isUpdatable</a>()[i])</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;          nb_local_nodes++;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      }</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      comm.<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm.html#a11c647080fe2f66181ba9355a3b2564b">all_reduce</a>(common::PE::plus(), &amp;nb_local_nodes, 1, &amp;<a class="code" href="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter.html#a954e7d37d84db51c2f781c22d6979add">global_nb_gid</a>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">else</span> <span class="comment">// When periodic links are provided, we must skip them in the GID list</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <a class="code" href="_assertions_8hpp.html#afc37f1da5066c36c3ab4bec9916bb919">cf3_assert</a>(periodic_links_active.size() == nb_nodes);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="keywordtype">int</span> nb_local_nodes = 0;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <span class="keywordtype">int</span> nb_local_periodic = 0;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i != nb_nodes; ++i)</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordflow">if</span>(cp.<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html#a51ea9eb6a3ff209a2385fec4358e2bf2">isUpdatable</a>()[i])</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;          <span class="keywordflow">if</span>(!periodic_links_active[i])</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            nb_local_nodes++;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;          {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            <a class="code" href="_assertions_8hpp.html#a17fffc472e1301f93a972a7aa952b900">cf3_assert_desc</a>(<span class="stringliteral">&quot;Periodic link for owned node &quot;</span> + <a class="code" href="namespacecf3_1_1common.html#a27234df9b48265a77ce04700d669d9c2">common::to_str</a>(i) + <span class="stringliteral">&quot;is on a different process&quot;</span>, cp.<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html#a51ea9eb6a3ff209a2385fec4358e2bf2">isUpdatable</a>()[periodic_links_nodes[i]]);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            nb_local_periodic++;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;          }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (periodic_links_active[i])</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;          <a class="code" href="_assertions_8hpp.html#a17fffc472e1301f93a972a7aa952b900">cf3_assert_desc</a>(<span class="stringliteral">&quot;Periodic link for ghost node &quot;</span> + <a class="code" href="namespacecf3_1_1common.html#a27234df9b48265a77ce04700d669d9c2">common::to_str</a>(i) + <span class="stringliteral">&quot;is on a my process&quot;</span>, !cp.<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html#a51ea9eb6a3ff209a2385fec4358e2bf2">isUpdatable</a>()[periodic_links_nodes[i]]);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      std::vector&lt;int&gt; base_gid_distribution; base_gid_distribution.reserve(nb_procs);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      std::vector&lt;int&gt; periodic_gid_distribution; periodic_gid_distribution.reserve(nb_procs);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <span class="keywordflow">if</span>(comm.<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm.html#a1c6aa4f12f0decd6ae4e88b9ea361126">is_active</a>())</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="comment">// Get the total number of elements on each rank</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        comm.<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm.html#ab14767bb48af273da59330cc5dd48896">all_gather</a>(nb_local_nodes, base_gid_distribution);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        comm.<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm.html#ab14767bb48af273da59330cc5dd48896">all_gather</a>(nb_local_periodic, periodic_gid_distribution);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        base_gid_distribution.push_back(nb_local_nodes);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        periodic_gid_distribution.push_back(nb_local_periodic);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      }</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <a class="code" href="_assertions_8hpp.html#afc37f1da5066c36c3ab4bec9916bb919">cf3_assert</a>(base_gid_distribution.size() == <a class="code" href="namespaceatest-ufem-navier-stokes-semi-implicit-laminar-channel-2d.html#ac7ab4d2aec28fbe3b32a56b67a766c33">nb_procs</a>);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <a class="code" href="_assertions_8hpp.html#afc37f1da5066c36c3ab4bec9916bb919">cf3_assert</a>(periodic_gid_distribution.size() == <a class="code" href="namespaceatest-ufem-navier-stokes-semi-implicit-laminar-channel-2d.html#ac7ab4d2aec28fbe3b32a56b67a766c33">nb_procs</a>);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> i = 1; i != <a class="code" href="namespaceatest-ufem-navier-stokes-semi-implicit-laminar-channel-2d.html#ac7ab4d2aec28fbe3b32a56b67a766c33">nb_procs</a>; ++i)</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        base_gid_distribution[i] += base_gid_distribution[i-1];</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        periodic_gid_distribution[i] += periodic_gid_distribution[i-1];</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <a class="code" href="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter.html#a954e7d37d84db51c2f781c22d6979add">global_nb_gid</a> = base_gid_distribution.back();</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="comment">// first gid on this rank. We renumber so all GIDs for non-periodic nodes come first</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> base_gid_counter = my_rank == 0 ? 0 : base_gid_distribution[my_rank-1];</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> periodic_gid_counter = (my_rank == 0 ? 0 : periodic_gid_distribution[my_rank-1]) + <a class="code" href="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter.html#a954e7d37d84db51c2f781c22d6979add">global_nb_gid</a>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <span class="comment">// Renumber gids</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> i = 0; i != nb_nodes; ++i)</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordflow">if</span>(cp.<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html#a51ea9eb6a3ff209a2385fec4358e2bf2">isUpdatable</a>()[i])</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;          <a class="code" href="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter.html#ac171b0b852cc936f754d5e5c54cd4305">gids</a>[i] = periodic_links_active[i] ? -1 : base_gid_counter++;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="keywordflow">if</span>(comm.<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm.html#a1c6aa4f12f0decd6ae4e88b9ea361126">is_active</a>())</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        cp.<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html#a140ffde97de87c9e5b249078d1813613">insert</a>(<span class="stringliteral">&quot;PeriodicGids&quot;</span>, <a class="code" href="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter.html#ac171b0b852cc936f754d5e5c54cd4305">gids</a>);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        cp.<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html#aeb050d84d432904f8a6cd0e3ea3bd76f">synchronize</a>(<span class="stringliteral">&quot;PeriodicGids&quot;</span>);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        cp.<a class="code" href="classcf3_1_1common_1_1_component.html#a6e7ffaf4fa803c959560c89a0ace1f2c">remove_component</a>(<span class="stringliteral">&quot;PeriodicGids&quot;</span>);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter.html#a74247cf730a06b23fcb1ec64e5596b25">  135</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter.html#a74247cf730a06b23fcb1ec64e5596b25">operator[]</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> i)<span class="keyword"> const</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <a class="code" href="_assertions_8hpp.html#a17fffc472e1301f93a972a7aa952b900">cf3_assert_desc</a>(<span class="stringliteral">&quot;Bad GID lookup on &quot;</span> + <a class="code" href="namespacecf3_1_1common.html#a27234df9b48265a77ce04700d669d9c2">common::to_str</a>(i), <a class="code" href="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter.html#ac171b0b852cc936f754d5e5c54cd4305">gids</a>[i] &gt;= 0);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter.html#ac171b0b852cc936f754d5e5c54cd4305">gids</a>[i];</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter.html#ac171b0b852cc936f754d5e5c54cd4305">  141</a></span>&#160;  std::vector&lt;int&gt; <a class="code" href="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter.html#ac171b0b852cc936f754d5e5c54cd4305">gids</a>;</div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter.html#a954e7d37d84db51c2f781c22d6979add">  142</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter.html#a954e7d37d84db51c2f781c22d6979add">global_nb_gid</a>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;};</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;}</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="namespacecf3_1_1math_1_1_l_s_s.html#ab9a4c7f520f4583581f3d84650c246c3">  147</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacecf3_1_1math_1_1_l_s_s.html#ab9a4c7f520f4583581f3d84650c246c3">create_map_data</a>(<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html">common::PE::CommPattern</a>&amp; cp, <span class="keyword">const</span> <a class="code" href="classcf3_1_1math_1_1_variables_descriptor.html">VariablesDescriptor</a>&amp; <a class="code" href="namespaceatest-conjugate-heat-flatplate.html#a2e399672267b9a9b9ae4bd60e97c3ec8">variables</a>, std::vector&lt; int &gt;&amp; p2m, std::vector&lt; int &gt;&amp; my_global_elements, std::vector&lt;Uint&gt;&amp; my_ranks, <span class="keywordtype">int</span>&amp; num_my_elements, <span class="keyword">const</span> std::vector&lt;Uint&gt;&amp; periodic_links_nodes, <span class="keyword">const</span> std::vector&lt;bool&gt;&amp; <a class="code" href="namespaceutest-zoltan-phg-periodic.html#aafeb66bf94b2b8727cb6c0bf275d77d0">periodic_links_active</a>)</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;{</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="comment">// get global ids vector</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keyword">const</span> <a class="code" href="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter.html">detail::GidConverter</a> gid(periodic_links_nodes, periodic_links_active, cp);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  num_my_elements = 0;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> nb_vars = variables.<a class="code" href="classcf3_1_1math_1_1_variables_descriptor.html#a16604c8a17c80d3bf17de445c65a7054">nb_vars</a>();</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> total_nb_eq = variables.<a class="code" href="classcf3_1_1math_1_1_variables_descriptor.html#a7b57596f80978d22c6a37ff1470c7316">size</a>();</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> nb_nodes_for_rank = cp.<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html#a51ea9eb6a3ff209a2385fec4358e2bf2">isUpdatable</a>().size();</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  my_global_elements.reserve(nb_nodes_for_rank*total_nb_eq);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  my_ranks.reserve(nb_nodes_for_rank*total_nb_eq);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordtype">int</span> nb_ghosts = 0;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> var_idx = 0; var_idx != nb_vars; ++var_idx)</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> neq = variables.<a class="code" href="classcf3_1_1math_1_1_variables_descriptor.html#a45cd2cf478d4c5141e034101c3605f9f">var_length</a>(var_idx);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> var_offset = variables.<a class="code" href="classcf3_1_1math_1_1_variables_descriptor.html#a3c124dc4115d6f1fb8e2629650cedb0a">offset</a>(var_idx);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> var_start_gid = var_offset * gid.<a class="code" href="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter.html#a954e7d37d84db51c2f781c22d6979add">global_nb_gid</a>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_nodes_for_rank; i++)</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="keywordflow">if</span> (cp.<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html#a51ea9eb6a3ff209a2385fec4358e2bf2">isUpdatable</a>()[i] &amp;&amp; !(periodic_links_active.size() &amp;&amp; periodic_links_active[i]))</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        num_my_elements += neq;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> start_gid = var_start_gid + gid[i]*neq;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j != neq; ++j)</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;          my_global_elements.push_back(start_gid+j);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;          my_ranks.push_back(cp.<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html#a83cd0c7f0771f1d6f48f11b256a70c5a">rank</a>(i));</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!cp.<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html#a51ea9eb6a3ff209a2385fec4358e2bf2">isUpdatable</a>()[i] &amp;&amp; !(periodic_links_active.size() &amp;&amp; periodic_links_active[i]))</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        nb_ghosts += neq;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="comment">// process local to matrix local numbering mapper</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_local_nodes = num_my_elements / total_nb_eq;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  nb_ghosts /= total_nb_eq;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  p2m.resize(nb_nodes_for_rank*total_nb_eq);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> var_idx = 0; var_idx != nb_vars; ++var_idx)</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> neq = variables.<a class="code" href="classcf3_1_1math_1_1_variables_descriptor.html#a45cd2cf478d4c5141e034101c3605f9f">var_length</a>(var_idx);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> var_offset = variables.<a class="code" href="classcf3_1_1math_1_1_variables_descriptor.html#a3c124dc4115d6f1fb8e2629650cedb0a">offset</a>(var_idx);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordtype">int</span> iupd=nb_local_nodes*var_offset;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordtype">int</span> ighost=num_my_elements + nb_ghosts*var_offset;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_nodes_for_rank; ++i)</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> p_start = i*total_nb_eq+var_offset;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <span class="keywordflow">if</span> (cp.<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html#a51ea9eb6a3ff209a2385fec4358e2bf2">isUpdatable</a>()[i] &amp;&amp; !(periodic_links_active.size() &amp;&amp; periodic_links_active[i]))</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> j = 0; j != neq; ++j)</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;          p2m[p_start + j] = iupd++;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!cp.<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html#a51ea9eb6a3ff209a2385fec4358e2bf2">isUpdatable</a>()[i] &amp;&amp; !(periodic_links_active.size() &amp;&amp; periodic_links_active[i]))</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> j = 0; j != neq; ++j)</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;          p2m[p_start + j] = ighost++;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">if</span>(!periodic_links_active.empty())</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_nodes_for_rank; ++i)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> p_start = i*total_nb_eq+var_offset;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordflow">if</span>(periodic_links_active[i])</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;          <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> final_linked_node = periodic_links_nodes[i];</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          <span class="keywordflow">while</span>(periodic_links_active[final_linked_node])</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            final_linked_node = periodic_links_nodes[final_linked_node];</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> p_linked = final_linked_node*total_nb_eq+var_offset;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;          <span class="keywordflow">for</span>(<a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> j = 0; j != neq; ++j)</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            p2m[p_start + j] = p2m[p_linked + j];</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="comment">// append the ghosts at the end of the element list</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> var_idx = 0; var_idx != nb_vars; ++var_idx)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> neq = variables.<a class="code" href="classcf3_1_1math_1_1_variables_descriptor.html#a45cd2cf478d4c5141e034101c3605f9f">var_length</a>(var_idx);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> var_offset = variables.<a class="code" href="classcf3_1_1math_1_1_variables_descriptor.html#a3c124dc4115d6f1fb8e2629650cedb0a">offset</a>(var_idx);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> var_start_gid = var_offset * gid.<a class="code" href="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter.html#a954e7d37d84db51c2f781c22d6979add">global_nb_gid</a>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_nodes_for_rank; i++)</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="keywordflow">if</span> (!cp.<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html#a51ea9eb6a3ff209a2385fec4358e2bf2">isUpdatable</a>()[i] &amp;&amp; !(periodic_links_active.size() &amp;&amp; periodic_links_active[i]))</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> start_gid = var_start_gid + gid[i]*neq;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j != neq; ++j)</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;          my_global_elements.push_back(start_gid+j);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;          my_ranks.push_back(cp.<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html#a83cd0c7f0771f1d6f48f11b256a70c5a">rank</a>(i));</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;}</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="namespacecf3_1_1math_1_1_l_s_s.html#a1df56788ac3632d3a0516e31a5013351">  251</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacecf3_1_1math_1_1_l_s_s.html#a1df56788ac3632d3a0516e31a5013351">create_indices_per_row</a>(<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html">cf3::common::PE::CommPattern</a>&amp; cp,</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                     <span class="keyword">const</span> <a class="code" href="classcf3_1_1math_1_1_variables_descriptor.html">VariablesDescriptor</a>&amp; <a class="code" href="namespaceatest-conjugate-heat-flatplate.html#a2e399672267b9a9b9ae4bd60e97c3ec8">variables</a>,</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                     <span class="keyword">const</span> std::vector&lt;Uint&gt;&amp; node_connectivity,</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                     <span class="keyword">const</span> std::vector&lt;Uint&gt;&amp; starting_indices,</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                     <span class="keyword">const</span> std::vector&lt;int&gt;&amp; p2m,</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                     std::vector&lt;int&gt;&amp; num_indices_per_row,</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                     std::vector&lt;int&gt;&amp; indices_per_row,</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                     <span class="keyword">const</span> std::vector&lt;Uint&gt;&amp; periodic_links_nodes,</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                     <span class="keyword">const</span> std::vector&lt;bool&gt;&amp; <a class="code" href="namespaceutest-zoltan-phg-periodic.html#aafeb66bf94b2b8727cb6c0bf275d77d0">periodic_links_active</a></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                    )</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;{</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> nb_vars = variables.<a class="code" href="classcf3_1_1math_1_1_variables_descriptor.html#a16604c8a17c80d3bf17de445c65a7054">nb_vars</a>();</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> total_nb_eq = variables.<a class="code" href="classcf3_1_1math_1_1_variables_descriptor.html#a7b57596f80978d22c6a37ff1470c7316">size</a>();</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> nb_nodes_for_rank = cp.<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html#a51ea9eb6a3ff209a2385fec4358e2bf2">isUpdatable</a>().size();</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <a class="code" href="_assertions_8hpp.html#afc37f1da5066c36c3ab4bec9916bb919">cf3_assert</a>(nb_nodes_for_rank+1 == starting_indices.size());</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keywordflow">if</span>(periodic_links_active.empty())</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">// Count the entries for each row</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> total_elements = 0;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> var_idx = 0; var_idx != nb_vars; ++var_idx)</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> neq = variables.<a class="code" href="classcf3_1_1math_1_1_variables_descriptor.html#a45cd2cf478d4c5141e034101c3605f9f">var_length</a>(var_idx);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_nodes_for_rank; i++)</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="keywordflow">if</span> (cp.<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html#a51ea9eb6a3ff209a2385fec4358e2bf2">isUpdatable</a>()[i])</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j != neq; ++j)</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;          {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            num_indices_per_row.push_back(total_nb_eq*(starting_indices[i+1]-starting_indices[i]));</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            total_elements += num_indices_per_row.back();</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;          }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">// Store the indices for each row</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    indices_per_row.reserve(total_elements);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> var_idx = 0; var_idx != nb_vars; ++var_idx)</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> neq = variables.<a class="code" href="classcf3_1_1math_1_1_variables_descriptor.html#a45cd2cf478d4c5141e034101c3605f9f">var_length</a>(var_idx);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_nodes_for_rank; i++)</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="keywordflow">if</span> (cp.<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html#a51ea9eb6a3ff209a2385fec4358e2bf2">isUpdatable</a>()[i])</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j != neq; ++j)</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;          {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> columns_begin = starting_indices[i];</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> columns_end = starting_indices[i+1];</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> <a class="code" href="namespaceutest-python-component.html#ae444945db5297bdd9e5c43355c9c76a1">l</a> = columns_begin; <a class="code" href="namespaceutest-python-component.html#ae444945db5297bdd9e5c43355c9c76a1">l</a> != columns_end; ++<a class="code" href="namespaceutest-python-component.html#ae444945db5297bdd9e5c43355c9c76a1">l</a>)</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> node_idx = node_connectivity[<a class="code" href="namespaceutest-python-component.html#ae444945db5297bdd9e5c43355c9c76a1">l</a>]*total_nb_eq;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="namespaceatest-ufem-heat1d-_p2.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a> = 0; <a class="code" href="namespaceatest-ufem-heat1d-_p2.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a> != total_nb_eq; ++<a class="code" href="namespaceatest-ufem-heat1d-_p2.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>)</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;              {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                indices_per_row.push_back(p2m[node_idx+<a class="code" href="namespaceatest-ufem-heat1d-_p2.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>]);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;              }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;          }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  }</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    std::vector&lt; std::vector&lt;Uint&gt; &gt; inverse_periodic_links(nb_nodes_for_rank);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <a class="code" href="_assertions_8hpp.html#afc37f1da5066c36c3ab4bec9916bb919">cf3_assert</a>(nb_nodes_for_rank == periodic_links_active.size());</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> i = 0; i != nb_nodes_for_rank; ++i)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="keywordflow">if</span>(periodic_links_active[i])</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      {</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> <a class="code" href="namespacecf3_1_1mesh_1_1actions_1_1detail.html#a618868597a36037d609c9976806d6571">final_target_node</a> = periodic_links_nodes[i];</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keywordflow">while</span>(periodic_links_active[final_target_node])</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;          final_target_node = periodic_links_nodes[<a class="code" href="namespacecf3_1_1mesh_1_1actions_1_1detail.html#a618868597a36037d609c9976806d6571">final_target_node</a>];</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        inverse_periodic_links[<a class="code" href="namespacecf3_1_1mesh_1_1actions_1_1detail.html#a618868597a36037d609c9976806d6571">final_target_node</a>].push_back(i);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">// With periodic links, we need to make sure each column is only accounted for once, hence the use of a set.</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    std::vector&lt; std::set&lt;Uint&gt; &gt; indices_per_row_sets;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    indices_per_row_sets.reserve(nb_nodes_for_rank);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> total_elements = 0;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    std::vector&lt;int&gt; row_nodes(8); <span class="comment">// 3D full periodic collapses at most 8 nodes</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> var_idx = 0; var_idx != nb_vars; ++var_idx)</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    {</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> neq = variables.<a class="code" href="classcf3_1_1math_1_1_variables_descriptor.html#a45cd2cf478d4c5141e034101c3605f9f">var_length</a>(var_idx);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_nodes_for_rank; i++)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="keywordflow">if</span> (cp.<a class="code" href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html#a51ea9eb6a3ff209a2385fec4358e2bf2">isUpdatable</a>()[i] &amp;&amp; !periodic_links_active[i])</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j != neq; ++j)</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;          {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            indices_per_row_sets.push_back( std::set&lt;Uint&gt;() );</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            row_nodes[0] = i;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            <a class="code" href="namespacecf3_1_1math.html#ac5d5fa5a985517723bdad7090f0845c4">std::copy</a>(inverse_periodic_links[i].begin(), inverse_periodic_links[i].end(), row_nodes.begin()+1);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> nb_row_nodes = 1 + inverse_periodic_links[i].size();</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> m = 0; m != nb_row_nodes; ++m)</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> columns_begin = starting_indices[row_nodes[m]];</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> columns_end = starting_indices[row_nodes[m]+1];</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;              <span class="keywordflow">for</span>(<a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> <a class="code" href="namespaceutest-python-component.html#ae444945db5297bdd9e5c43355c9c76a1">l</a> = columns_begin; <a class="code" href="namespaceutest-python-component.html#ae444945db5297bdd9e5c43355c9c76a1">l</a> != columns_end; ++<a class="code" href="namespaceutest-python-component.html#ae444945db5297bdd9e5c43355c9c76a1">l</a>)</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;              {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                <span class="keyword">const</span> <a class="code" href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">Uint</a> node_idx = node_connectivity[<a class="code" href="namespaceutest-python-component.html#ae444945db5297bdd9e5c43355c9c76a1">l</a>]*total_nb_eq;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="namespaceatest-ufem-heat1d-_p2.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a> = 0; <a class="code" href="namespaceatest-ufem-heat1d-_p2.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a> != total_nb_eq; ++<a class="code" href="namespaceatest-ufem-heat1d-_p2.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>)</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                  indices_per_row_sets.back().insert(p2m[node_idx+<a class="code" href="namespaceatest-ufem-heat1d-_p2.html#ab66ed8e0098c0a86b458672a55a9cca9">k</a>]);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;              }</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            total_elements += indices_per_row_sets.back().size();</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;          }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    }</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    indices_per_row.reserve(total_elements);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    BOOST_FOREACH(<span class="keyword">const</span> std::set&lt;Uint&gt;&amp; row_nodes, indices_per_row_sets)</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      num_indices_per_row.push_back(row_nodes.size());</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      indices_per_row.insert(indices_per_row.end(), row_nodes.begin(), row_nodes.end());</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    }</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;}</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div>
<div class="line"><a name="l00380"></a><span class="lineno"><a class="line" href="namespacecf3_1_1math_1_1_l_s_s.html#a350814209aed7eb6e9df8776f83fa8a8">  380</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacecf3_1_1math_1_1_l_s_s.html#a350814209aed7eb6e9df8776f83fa8a8">apply_matrix</a> ( <span class="keyword">const</span> Epetra_Operator&amp; op, <span class="keyword">const</span> <a class="code" href="classcf3_1_1_handle.html">Handle&lt; Vector &gt;</a>&amp; <a class="code" href="namespaceutest-solver-actions-randomize.html#a85c9a6647898bbc94de1619f3318ba8f">y</a>, <span class="keyword">const</span> <a class="code" href="classcf3_1_1_handle.html">cf3::Handle&lt; const Vector &gt;</a>&amp; <a class="code" href="namespaceatest-quadtriag.html#a573e66358ede67c6f901dfaf4722f75a">x</a>, <span class="keyword">const</span> Real alpha, <span class="keyword">const</span> Real <a class="code" href="namespaceatest-ufem-particles-taylor-green-polydisperse.html#a684b1df447558ad94b70028b3292227e">beta</a> )</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;{</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <a class="code" href="classcf3_1_1_handle.html">Handle&lt;TrilinosVector&gt;</a> y_tril(y);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <a class="code" href="classcf3_1_1_handle.html">Handle&lt;TrilinosVector const&gt;</a> x_tril(x);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="namespacecf3.html#ac59f1806469ed1c2235b5129a2e40640">is_null</a>(y_tril) || <a class="code" href="namespacecf3.html#ac59f1806469ed1c2235b5129a2e40640">is_null</a>(x_tril))</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="structcf3_1_1common_1_1_setup_error.html">common::SetupError</a>(<a class="code" href="_code_location_8hpp.html#acc1ba5f90e834dec77544016b6b5619d">FromHere</a>(), <span class="stringliteral">&quot;Trilinos*Matrix::apply must be given TrilinosVector arguments&quot;</span>);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <a class="code" href="_assertions_8hpp.html#afc37f1da5066c36c3ab4bec9916bb919">cf3_assert</a>(op.OperatorDomainMap().PointSameAs(x_tril-&gt;<a class="code" href="classcf3_1_1math_1_1_l_s_s_1_1_trilinos_vector.html#a8a4d7d516f4c0fd72019751458005405">epetra_vector</a>()-&gt;Map()));</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="comment">// Store the old values of y since we need them later on</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  Teuchos::RCP&lt;Epetra_Vector&gt; temp;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="keywordflow">if</span>(beta != 0.)</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    temp = Teuchos::rcp(<span class="keyword">new</span> Epetra_Vector(*y_tril-&gt;<a class="code" href="classcf3_1_1math_1_1_l_s_s_1_1_trilinos_vector.html#a8a4d7d516f4c0fd72019751458005405">epetra_vector</a>()));</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="comment">// Apply the operator</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <a class="code" href="_trilinos_vector_8hpp.html#a53867a72a773fc1e6d51a9f9ec946951">TRILINOS_THROW</a>(op.Apply(*x_tril-&gt;<a class="code" href="classcf3_1_1math_1_1_l_s_s_1_1_trilinos_vector.html#a8a4d7d516f4c0fd72019751458005405">epetra_vector</a>(), *y_tril-&gt;<a class="code" href="classcf3_1_1math_1_1_l_s_s_1_1_trilinos_vector.html#a8a4d7d516f4c0fd72019751458005405">epetra_vector</a>()));</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="comment">// Scale the result if needed</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="keywordflow">if</span>(alpha != 1.)</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    y_tril-&gt;<a class="code" href="classcf3_1_1math_1_1_l_s_s_1_1_trilinos_vector.html#a8a4d7d516f4c0fd72019751458005405">epetra_vector</a>()-&gt;Scale(alpha);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="comment">// Add in old values if needed</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="keywordflow">if</span>(beta != 0.)</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    y_tril-&gt;<a class="code" href="classcf3_1_1math_1_1_l_s_s_1_1_trilinos_vector.html#a8a4d7d516f4c0fd72019751458005405">epetra_vector</a>()-&gt;Update(beta, *temp, 1.);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;}</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;} <span class="comment">// namespace LSS</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;} <span class="comment">// namespace math</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;} <span class="comment">// namespace cf3</span></div>
<div class="ttc" id="classcf3_1_1common_1_1_p_e_1_1_comm_html_a11c647080fe2f66181ba9355a3b2564b"><div class="ttname"><a href="classcf3_1_1common_1_1_p_e_1_1_comm.html#a11c647080fe2f66181ba9355a3b2564b">cf3::common::PE::Comm::all_reduce</a></div><div class="ttdeci">T * all_reduce(const Op &amp;op, const T *in_values, const int in_n, T *out_values, const int stride=1)</div><div class="ttdef"><b>Definition:</b> <a href="_comm_8hpp_source.html#l00282">Comm.hpp:282</a></div></div>
<div class="ttc" id="_trilinos_vector_8hpp_html"><div class="ttname"><a href="_trilinos_vector_8hpp.html">TrilinosVector.hpp</a></div></div>
<div class="ttc" id="classcf3_1_1math_1_1_l_s_s_1_1_trilinos_vector_html_a8a4d7d516f4c0fd72019751458005405"><div class="ttname"><a href="classcf3_1_1math_1_1_l_s_s_1_1_trilinos_vector.html#a8a4d7d516f4c0fd72019751458005405">cf3::math::LSS::TrilinosVector::epetra_vector</a></div><div class="ttdeci">Teuchos::RCP&lt; Epetra_Vector &gt; epetra_vector()</div><div class="ttdef"><b>Definition:</b> <a href="_trilinos_vector_8hpp_source.html#l00155">TrilinosVector.hpp:155</a></div></div>
<div class="ttc" id="namespacecf3_html_ac59f1806469ed1c2235b5129a2e40640"><div class="ttname"><a href="namespacecf3.html#ac59f1806469ed1c2235b5129a2e40640">cf3::is_null</a></div><div class="ttdeci">bool is_null(T ptr)</div><div class="ttdoc">predicate for comparison to nullptr </div><div class="ttdef"><b>Definition:</b> <a href="_c_f_8hpp_source.html#l00151">CF.hpp:151</a></div></div>
<div class="ttc" id="classcf3_1_1_handle_html"><div class="ttname"><a href="classcf3_1_1_handle.html">cf3::Handle</a></div><div class="ttdoc">Safe pointer to an object. This is the supported method for referring to components. </div><div class="ttdef"><b>Definition:</b> <a href="_handle_8hpp_source.html#l00039">Handle.hpp:39</a></div></div>
<div class="ttc" id="classcf3_1_1common_1_1_p_e_1_1_comm_pattern_html_a83cd0c7f0771f1d6f48f11b256a70c5a"><div class="ttname"><a href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html#a83cd0c7f0771f1d6f48f11b256a70c5a">cf3::common::PE::CommPattern::rank</a></div><div class="ttdeci">int rank(const Uint lid) const </div><div class="ttdoc">Return the rank associated with the given local ID. </div><div class="ttdef"><b>Definition:</b> <a href="_comm_pattern_8hpp_source.html#l00285">CommPattern.hpp:285</a></div></div>
<div class="ttc" id="namespacecf3_1_1math_html_ac5d5fa5a985517723bdad7090f0845c4"><div class="ttname"><a href="namespacecf3_1_1math.html#ac5d5fa5a985517723bdad7090f0845c4">cf3::math::copy</a></div><div class="ttdeci">void copy(const std::vector&lt; Real &gt; &amp;vector, RealMatrix &amp;realmatrix)</div><div class="ttdoc">Copy std::vector to dynamic RealMatrix types. </div><div class="ttdef"><b>Definition:</b> <a href="_matrix_types_conversion_8hpp_source.html#l00088">MatrixTypesConversion.hpp:88</a></div></div>
<div class="ttc" id="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter_html"><div class="ttname"><a href="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter.html">cf3::math::LSS::detail::GidConverter</a></div><div class="ttdef"><b>Definition:</b> <a href="_trilinos_detail_8cpp_source.html#l00040">TrilinosDetail.cpp:40</a></div></div>
<div class="ttc" id="_comm_pattern_8hpp_html"><div class="ttname"><a href="_comm_pattern_8hpp.html">CommPattern.hpp</a></div><div class="ttdoc">Parallel Communication Pattern. This class provides functionality to collect communication. For efficiency it works such a way that you submit your request via the constructor or the add/remove/move magic triangle and then call setup to modify the commpattern. The data needed to be kept synchronous can be registered via the insert function. The word node here means any kind of "point of storage", in this context it is not directly related with the computational mesh. </div></div>
<div class="ttc" id="namespaceutest-python-component_html_ae444945db5297bdd9e5c43355c9c76a1"><div class="ttname"><a href="namespaceutest-python-component.html#ae444945db5297bdd9e5c43355c9c76a1">utest-python-component.l</a></div><div class="ttdeci">tuple l</div><div class="ttdef"><b>Definition:</b> <a href="utest-python-component_8py_source.html#l00025">utest-python-component.py:25</a></div></div>
<div class="ttc" id="_assertions_8hpp_html_afc37f1da5066c36c3ab4bec9916bb919"><div class="ttname"><a href="_assertions_8hpp.html#afc37f1da5066c36c3ab4bec9916bb919">cf3_assert</a></div><div class="ttdeci">#define cf3_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="_assertions_8hpp_source.html#l00093">Assertions.hpp:93</a></div></div>
<div class="ttc" id="namespaceatest-ufem-particles-taylor-green-polydisperse_html_a684b1df447558ad94b70028b3292227e"><div class="ttname"><a href="namespaceatest-ufem-particles-taylor-green-polydisperse.html#a684b1df447558ad94b70028b3292227e">atest-ufem-particles-taylor-green-polydisperse.beta</a></div><div class="ttdeci">int beta</div><div class="ttdef"><b>Definition:</b> <a href="atest-ufem-particles-taylor-green-polydisperse_8py_source.html#l00023">atest-ufem-particles-taylor-green-polydisperse.py:23</a></div></div>
<div class="ttc" id="classcf3_1_1common_1_1_p_e_1_1_comm_pattern_html"><div class="ttname"><a href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html">cf3::common::PE::CommPattern</a></div><div class="ttdef"><b>Definition:</b> <a href="_comm_pattern_8hpp_source.html#l00041">CommPattern.hpp:41</a></div></div>
<div class="ttc" id="namespaceutest-zoltan-phg-periodic_html_aafeb66bf94b2b8727cb6c0bf275d77d0"><div class="ttname"><a href="namespaceutest-zoltan-phg-periodic.html#aafeb66bf94b2b8727cb6c0bf275d77d0">utest-zoltan-phg-periodic.periodic_links_active</a></div><div class="ttdeci">periodic_links_active</div><div class="ttdef"><b>Definition:</b> <a href="utest-zoltan-phg-periodic_8py_source.html#l00053">utest-zoltan-phg-periodic.py:53</a></div></div>
<div class="ttc" id="structcf3_1_1common_1_1_setup_error_html"><div class="ttname"><a href="structcf3_1_1common_1_1_setup_error.html">cf3::common::SetupError</a></div><div class="ttdef"><b>Definition:</b> <a href="_basic_exceptions_8hpp_source.html#l00213">BasicExceptions.hpp:213</a></div></div>
<div class="ttc" id="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter_html_a55239b5970154fd1e562ea4a17e97c66"><div class="ttname"><a href="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter.html#a55239b5970154fd1e562ea4a17e97c66">cf3::math::LSS::detail::GidConverter::GidConverter</a></div><div class="ttdeci">GidConverter(const std::vector&lt; Uint &gt; &amp;periodic_links_nodes, const std::vector&lt; bool &gt; &amp;periodic_links_active, common::PE::CommPattern &amp;cp)</div><div class="ttdef"><b>Definition:</b> <a href="_trilinos_detail_8cpp_source.html#l00042">TrilinosDetail.cpp:42</a></div></div>
<div class="ttc" id="classcf3_1_1common_1_1_p_e_1_1_comm_html_a3473b7dc6bd43215734cdefc4b0f0d28"><div class="ttname"><a href="classcf3_1_1common_1_1_p_e_1_1_comm.html#a3473b7dc6bd43215734cdefc4b0f0d28">cf3::common::PE::Comm::rank</a></div><div class="ttdeci">Uint rank() const </div><div class="ttdoc">Return rank, additionally, if is_init==0. </div><div class="ttdef"><b>Definition:</b> <a href="_comm_8cpp_source.html#l00135">Comm.cpp:135</a></div></div>
<div class="ttc" id="classcf3_1_1common_1_1_p_e_1_1_comm_pattern_html_a140ffde97de87c9e5b249078d1813613"><div class="ttname"><a href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html#a140ffde97de87c9e5b249078d1813613">cf3::common::PE::CommPattern::insert</a></div><div class="ttdeci">void insert(const std::string &amp;name, T *&amp;data, const int size, const unsigned int stride=1, const bool needs_update=true)</div><div class="ttdef"><b>Definition:</b> <a href="_comm_pattern_8hpp_source.html#l00139">CommPattern.hpp:139</a></div></div>
<div class="ttc" id="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter_html_a74247cf730a06b23fcb1ec64e5596b25"><div class="ttname"><a href="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter.html#a74247cf730a06b23fcb1ec64e5596b25">cf3::math::LSS::detail::GidConverter::operator[]</a></div><div class="ttdeci">int operator[](const int i) const </div><div class="ttdef"><b>Definition:</b> <a href="_trilinos_detail_8cpp_source.html#l00135">TrilinosDetail.cpp:135</a></div></div>
<div class="ttc" id="namespacecf3_1_1common_html_a27234df9b48265a77ce04700d669d9c2"><div class="ttname"><a href="namespacecf3_1_1common.html#a27234df9b48265a77ce04700d669d9c2">cf3::common::to_str</a></div><div class="ttdeci">Common_API std::string to_str(const T &amp;v)</div><div class="ttdoc">Converts to std::string. </div></div>
<div class="ttc" id="classcf3_1_1common_1_1_p_e_1_1_comm_html_a7b57596f80978d22c6a37ff1470c7316"><div class="ttname"><a href="classcf3_1_1common_1_1_p_e_1_1_comm.html#a7b57596f80978d22c6a37ff1470c7316">cf3::common::PE::Comm::size</a></div><div class="ttdeci">Uint size() const </div><div class="ttdoc">Return the number of processes, or 1 if is_init==0. </div><div class="ttdef"><b>Definition:</b> <a href="_comm_8cpp_source.html#l00145">Comm.cpp:145</a></div></div>
<div class="ttc" id="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter_html_a954e7d37d84db51c2f781c22d6979add"><div class="ttname"><a href="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter.html#a954e7d37d84db51c2f781c22d6979add">cf3::math::LSS::detail::GidConverter::global_nb_gid</a></div><div class="ttdeci">int global_nb_gid</div><div class="ttdef"><b>Definition:</b> <a href="_trilinos_detail_8cpp_source.html#l00142">TrilinosDetail.cpp:142</a></div></div>
<div class="ttc" id="namespaceatest-ufem-navier-stokes-semi-implicit-laminar-channel-2d_html_ac7ab4d2aec28fbe3b32a56b67a766c33"><div class="ttname"><a href="namespaceatest-ufem-navier-stokes-semi-implicit-laminar-channel-2d.html#ac7ab4d2aec28fbe3b32a56b67a766c33">atest-ufem-navier-stokes-semi-implicit-laminar-channel-2d.nb_procs</a></div><div class="ttdeci">tuple nb_procs</div><div class="ttdef"><b>Definition:</b> <a href="atest-ufem-navier-stokes-semi-implicit-laminar-channel-2d_8py_source.html#l00075">atest-ufem-navier-stokes-semi-implicit-laminar-channel-2d.py:75</a></div></div>
<div class="ttc" id="namespaceatest-quadtriag_html_a573e66358ede67c6f901dfaf4722f75a"><div class="ttname"><a href="namespaceatest-quadtriag.html#a573e66358ede67c6f901dfaf4722f75a">atest-quadtriag.x</a></div><div class="ttdeci">list x</div><div class="ttdef"><b>Definition:</b> <a href="atest-quadtriag_8py_source.html#l00034">atest-quadtriag.py:34</a></div></div>
<div class="ttc" id="classcf3_1_1math_1_1_variables_descriptor_html"><div class="ttname"><a href="classcf3_1_1math_1_1_variables_descriptor.html">cf3::math::VariablesDescriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="_variables_descriptor_8hpp_source.html#l00030">VariablesDescriptor.hpp:30</a></div></div>
<div class="ttc" id="namespacecf3_1_1math_1_1_l_s_s_html_a350814209aed7eb6e9df8776f83fa8a8"><div class="ttname"><a href="namespacecf3_1_1math_1_1_l_s_s.html#a350814209aed7eb6e9df8776f83fa8a8">cf3::math::LSS::apply_matrix</a></div><div class="ttdeci">void apply_matrix(const Epetra_Operator &amp;op, const Handle&lt; Vector &gt; &amp;y, const cf3::Handle&lt; const Vector &gt; &amp;x, const Real alpha, const Real beta)</div><div class="ttdoc">Compute y = alpha*op*x + beta*y. </div><div class="ttdef"><b>Definition:</b> <a href="_trilinos_detail_8cpp_source.html#l00380">TrilinosDetail.cpp:380</a></div></div>
<div class="ttc" id="namespaceutest-zoltan-phg-periodic_html_ad73008b6ed5017afc0f317696b61ca18"><div class="ttname"><a href="namespaceutest-zoltan-phg-periodic.html#ad73008b6ed5017afc0f317696b61ca18">utest-zoltan-phg-periodic.my_rank</a></div><div class="ttdeci">tuple my_rank</div><div class="ttdef"><b>Definition:</b> <a href="utest-zoltan-phg-periodic_8py_source.html#l00051">utest-zoltan-phg-periodic.py:51</a></div></div>
<div class="ttc" id="_assertions_8hpp_html_a17fffc472e1301f93a972a7aa952b900"><div class="ttname"><a href="_assertions_8hpp.html#a17fffc472e1301f93a972a7aa952b900">cf3_assert_desc</a></div><div class="ttdeci">#define cf3_assert_desc(m, a)</div><div class="ttdef"><b>Definition:</b> <a href="_assertions_8hpp_source.html#l00094">Assertions.hpp:94</a></div></div>
<div class="ttc" id="classcf3_1_1common_1_1_p_e_1_1_comm_html_a1c6aa4f12f0decd6ae4e88b9ea361126"><div class="ttname"><a href="classcf3_1_1common_1_1_p_e_1_1_comm.html#a1c6aa4f12f0decd6ae4e88b9ea361126">cf3::common::PE::Comm::is_active</a></div><div class="ttdeci">bool is_active() const </div><div class="ttdef"><b>Definition:</b> <a href="_comm_8hpp_source.html#l00083">Comm.hpp:83</a></div></div>
<div class="ttc" id="_variables_descriptor_8hpp_html"><div class="ttname"><a href="_variables_descriptor_8hpp.html">VariablesDescriptor.hpp</a></div></div>
<div class="ttc" id="classcf3_1_1math_1_1_variables_descriptor_html_a7b57596f80978d22c6a37ff1470c7316"><div class="ttname"><a href="classcf3_1_1math_1_1_variables_descriptor.html#a7b57596f80978d22c6a37ff1470c7316">cf3::math::VariablesDescriptor::size</a></div><div class="ttdeci">Uint size() const </div><div class="ttdef"><b>Definition:</b> <a href="_variables_descriptor_8cpp_source.html#l00421">VariablesDescriptor.cpp:421</a></div></div>
<div class="ttc" id="namespacecf3_html"><div class="ttname"><a href="namespacecf3.html">cf3</a></div><div class="ttdoc">Top-level namespace for coolfluid. </div><div class="ttdef"><b>Definition:</b> <a href="common_2_action_8cpp_source.html#l00018">Action.cpp:18</a></div></div>
<div class="ttc" id="namespaceutest-solver-actions-randomize_html_a85c9a6647898bbc94de1619f3318ba8f"><div class="ttname"><a href="namespaceutest-solver-actions-randomize.html#a85c9a6647898bbc94de1619f3318ba8f">utest-solver-actions-randomize.y</a></div><div class="ttdeci">list y</div><div class="ttdef"><b>Definition:</b> <a href="utest-solver-actions-randomize_8py_source.html#l00056">utest-solver-actions-randomize.py:56</a></div></div>
<div class="ttc" id="namespaceatest-conjugate-heat-flatplate_html_a2e399672267b9a9b9ae4bd60e97c3ec8"><div class="ttname"><a href="namespaceatest-conjugate-heat-flatplate.html#a2e399672267b9a9b9ae4bd60e97c3ec8">atest-conjugate-heat-flatplate.variables</a></div><div class="ttdeci">tuple variables</div><div class="ttdef"><b>Definition:</b> <a href="atest-conjugate-heat-flatplate_8py_source.html#l00122">atest-conjugate-heat-flatplate.py:122</a></div></div>
<div class="ttc" id="classcf3_1_1math_1_1_variables_descriptor_html_a3c124dc4115d6f1fb8e2629650cedb0a"><div class="ttname"><a href="classcf3_1_1math_1_1_variables_descriptor.html#a3c124dc4115d6f1fb8e2629650cedb0a">cf3::math::VariablesDescriptor::offset</a></div><div class="ttdeci">Uint offset(const std::string &amp;name) const </div><div class="ttdef"><b>Definition:</b> <a href="_variables_descriptor_8cpp_source.html#l00435">VariablesDescriptor.cpp:435</a></div></div>
<div class="ttc" id="classcf3_1_1math_1_1_variables_descriptor_html_a16604c8a17c80d3bf17de445c65a7054"><div class="ttname"><a href="classcf3_1_1math_1_1_variables_descriptor.html#a16604c8a17c80d3bf17de445c65a7054">cf3::math::VariablesDescriptor::nb_vars</a></div><div class="ttdeci">Uint nb_vars() const </div><div class="ttdef"><b>Definition:</b> <a href="_variables_descriptor_8cpp_source.html#l00414">VariablesDescriptor.cpp:414</a></div></div>
<div class="ttc" id="_trilinos_detail_8hpp_html"><div class="ttname"><a href="_trilinos_detail_8hpp.html">TrilinosDetail.hpp</a></div></div>
<div class="ttc" id="_trilinos_vector_8hpp_html_a53867a72a773fc1e6d51a9f9ec946951"><div class="ttname"><a href="_trilinos_vector_8hpp.html#a53867a72a773fc1e6d51a9f9ec946951">TRILINOS_THROW</a></div><div class="ttdeci">#define TRILINOS_THROW(trilinos_function_call)</div><div class="ttdef"><b>Definition:</b> <a href="_trilinos_vector_8hpp_source.html#l00042">TrilinosVector.hpp:42</a></div></div>
<div class="ttc" id="namespacecf3_1_1mesh_1_1actions_1_1detail_html_a618868597a36037d609c9976806d6571"><div class="ttname"><a href="namespacecf3_1_1mesh_1_1actions_1_1detail.html#a618868597a36037d609c9976806d6571">cf3::mesh::actions::detail::final_target_node</a></div><div class="ttdeci">Uint final_target_node(const common::List&lt; Uint &gt; &amp;periodic_links_nodes, const common::List&lt; bool &gt; &amp;periodic_links_active, Uint node)</div><div class="ttdef"><b>Definition:</b> <a href="_periodic_mesh_partitioner_8cpp_source.html#l00054">PeriodicMeshPartitioner.cpp:54</a></div></div>
<div class="ttc" id="classcf3_1_1common_1_1_p_e_1_1_comm_pattern_html_aeb050d84d432904f8a6cd0e3ea3bd76f"><div class="ttname"><a href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html#aeb050d84d432904f8a6cd0e3ea3bd76f">cf3::common::PE::CommPattern::synchronize</a></div><div class="ttdeci">void synchronize(const std::string &amp;name)</div></div>
<div class="ttc" id="classcf3_1_1common_1_1_component_html_a6e7ffaf4fa803c959560c89a0ace1f2c"><div class="ttname"><a href="classcf3_1_1common_1_1_component.html#a6e7ffaf4fa803c959560c89a0ace1f2c">cf3::common::Component::remove_component</a></div><div class="ttdeci">boost::shared_ptr&lt; Component &gt; remove_component(const std::string &amp;name)</div><div class="ttdoc">Remove a (sub)component of this component. </div><div class="ttdef"><b>Definition:</b> <a href="_component_8cpp_source.html#l00357">Component.cpp:357</a></div></div>
<div class="ttc" id="namespacecf3_html_a4840c4503b7d10cea5e08416eb3716f1"><div class="ttname"><a href="namespacecf3.html#a4840c4503b7d10cea5e08416eb3716f1">cf3::Uint</a></div><div class="ttdeci">unsigned int Uint</div><div class="ttdoc">typedef for unsigned int </div><div class="ttdef"><b>Definition:</b> <a href="_c_f_8hpp_source.html#l00090">CF.hpp:90</a></div></div>
<div class="ttc" id="namespacecf3_1_1math_1_1_l_s_s_html_ab9a4c7f520f4583581f3d84650c246c3"><div class="ttname"><a href="namespacecf3_1_1math_1_1_l_s_s.html#ab9a4c7f520f4583581f3d84650c246c3">cf3::math::LSS::create_map_data</a></div><div class="ttdeci">void create_map_data(common::PE::CommPattern &amp;cp, const VariablesDescriptor &amp;variables, std::vector&lt; int &gt; &amp;p2m, std::vector&lt; int &gt; &amp;my_global_elements, std::vector&lt; Uint &gt; &amp;my_ranks, int &amp;num_my_elements, const std::vector&lt; Uint &gt; &amp;periodic_links_nodes, const std::vector&lt; bool &gt; &amp;periodic_links_active)</div><div class="ttdef"><b>Definition:</b> <a href="_trilinos_detail_8cpp_source.html#l00147">TrilinosDetail.cpp:147</a></div></div>
<div class="ttc" id="_log_8hpp_html"><div class="ttname"><a href="_log_8hpp.html">Log.hpp</a></div></div>
<div class="ttc" id="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter_html_ac171b0b852cc936f754d5e5c54cd4305"><div class="ttname"><a href="structcf3_1_1math_1_1_l_s_s_1_1detail_1_1_gid_converter.html#ac171b0b852cc936f754d5e5c54cd4305">cf3::math::LSS::detail::GidConverter::gids</a></div><div class="ttdeci">std::vector&lt; int &gt; gids</div><div class="ttdef"><b>Definition:</b> <a href="_trilinos_detail_8cpp_source.html#l00141">TrilinosDetail.cpp:141</a></div></div>
<div class="ttc" id="classcf3_1_1math_1_1_variables_descriptor_html_a45cd2cf478d4c5141e034101c3605f9f"><div class="ttname"><a href="classcf3_1_1math_1_1_variables_descriptor.html#a45cd2cf478d4c5141e034101c3605f9f">cf3::math::VariablesDescriptor::var_length</a></div><div class="ttdeci">Uint var_length(const std::string &amp;name) const </div><div class="ttdef"><b>Definition:</b> <a href="_variables_descriptor_8cpp_source.html#l00471">VariablesDescriptor.cpp:471</a></div></div>
<div class="ttc" id="namespaceatest-ufem-heat1d-_p2_html_ab66ed8e0098c0a86b458672a55a9cca9"><div class="ttname"><a href="namespaceatest-ufem-heat1d-_p2.html#ab66ed8e0098c0a86b458672a55a9cca9">atest-ufem-heat1d-P2.k</a></div><div class="ttdeci">int k</div><div class="ttdef"><b>Definition:</b> <a href="atest-ufem-heat1d-_p2_8py_source.html#l00018">atest-ufem-heat1d-P2.py:18</a></div></div>
<div class="ttc" id="namespacecf3_1_1math_1_1_l_s_s_html_a1df56788ac3632d3a0516e31a5013351"><div class="ttname"><a href="namespacecf3_1_1math_1_1_l_s_s.html#a1df56788ac3632d3a0516e31a5013351">cf3::math::LSS::create_indices_per_row</a></div><div class="ttdeci">void create_indices_per_row(cf3::common::PE::CommPattern &amp;cp, const VariablesDescriptor &amp;variables, const std::vector&lt; Uint &gt; &amp;node_connectivity, const std::vector&lt; Uint &gt; &amp;starting_indices, const std::vector&lt; int &gt; &amp;p2m, std::vector&lt; int &gt; &amp;num_indices_per_row, std::vector&lt; int &gt; &amp;indices_per_row, const std::vector&lt; Uint &gt; &amp;periodic_links_nodes, const std::vector&lt; bool &gt; &amp;periodic_links_active)</div><div class="ttdef"><b>Definition:</b> <a href="_trilinos_detail_8cpp_source.html#l00251">TrilinosDetail.cpp:251</a></div></div>
<div class="ttc" id="classcf3_1_1common_1_1_p_e_1_1_comm_html_acde39a003bff65c47326f0b0b8610c7e"><div class="ttname"><a href="classcf3_1_1common_1_1_p_e_1_1_comm.html#acde39a003bff65c47326f0b0b8610c7e">cf3::common::PE::Comm::instance</a></div><div class="ttdeci">static Comm &amp; instance()</div><div class="ttdoc">Return a reference to the current PE. </div><div class="ttdef"><b>Definition:</b> <a href="_comm_8cpp_source.html#l00044">Comm.cpp:44</a></div></div>
<div class="ttc" id="classcf3_1_1common_1_1_p_e_1_1_comm_html_ab14767bb48af273da59330cc5dd48896"><div class="ttname"><a href="classcf3_1_1common_1_1_p_e_1_1_comm.html#ab14767bb48af273da59330cc5dd48896">cf3::common::PE::Comm::all_gather</a></div><div class="ttdeci">T * all_gather(const T *in_values, const int in_n, T *out_values, const int stride=1)</div><div class="ttdef"><b>Definition:</b> <a href="_comm_8hpp_source.html#l00192">Comm.hpp:192</a></div></div>
<div class="ttc" id="classcf3_1_1common_1_1_p_e_1_1_comm_html"><div class="ttname"><a href="classcf3_1_1common_1_1_p_e_1_1_comm.html">cf3::common::PE::Comm</a></div><div class="ttdef"><b>Definition:</b> <a href="_comm_8hpp_source.html#l00051">Comm.hpp:51</a></div></div>
<div class="ttc" id="classcf3_1_1common_1_1_p_e_1_1_comm_pattern_html_a51ea9eb6a3ff209a2385fec4358e2bf2"><div class="ttname"><a href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html#a51ea9eb6a3ff209a2385fec4358e2bf2">cf3::common::PE::CommPattern::isUpdatable</a></div><div class="ttdeci">std::vector&lt; bool &gt; &amp; isUpdatable()</div><div class="ttdef"><b>Definition:</b> <a href="_comm_pattern_8hpp_source.html#l00282">CommPattern.hpp:282</a></div></div>
<div class="ttc" id="_comm_8hpp_html"><div class="ttname"><a href="_comm_8hpp.html">Comm.hpp</a></div></div>
<div class="ttc" id="classcf3_1_1common_1_1_p_e_1_1_comm_pattern_html_a2ae90dcd92e4a1c700dbdd10b78021f5"><div class="ttname"><a href="classcf3_1_1common_1_1_p_e_1_1_comm_pattern.html#a2ae90dcd92e4a1c700dbdd10b78021f5">cf3::common::PE::CommPattern::gid</a></div><div class="ttdeci">const Handle&lt; CommWrapper &gt; gid() const </div><div class="ttdef"><b>Definition:</b> <a href="_comm_pattern_8hpp_source.html#l00278">CommPattern.hpp:278</a></div></div>
<div class="ttc" id="_code_location_8hpp_html_acc1ba5f90e834dec77544016b6b5619d"><div class="ttname"><a href="_code_location_8hpp.html#acc1ba5f90e834dec77544016b6b5619d">FromHere</a></div><div class="ttdeci">#define FromHere()</div><div class="ttdef"><b>Definition:</b> <a href="_code_location_8hpp_source.html#l00045">CodeLocation.hpp:45</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Jun 14 2015 21:20:10 for COOLFluiD by&nbsp;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1</small></address>
<table width="100%">
  <tr>
    <td>
    </td>
    <td align="right" valign="center">
      Send comments to:<br>
      <a href="mailto:coolfluid@vki.ac.be">COOLFluiD Web Admin</a>
    </td>
  </tr>
</table>
</body>
</html>
